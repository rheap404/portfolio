---
import { Icon } from "astro-icon/components";
import "../styles/global.css";

const navLinks = [
  { label: "Home", href: "/" },
  { label: "Projects", href: "/projects" },
  { label: "Skills", href: "/skills" },
];
const { header } = Astro.props;
---

<header class="font-darker font-light text-2xl md:sticky top-2 z-20">
  <div class="md:sticky top-2 z-20">
    <div
      id="header-shell"
      class="mx-auto w-full transition-[width] duration-500 ease-in-out"
    >
      {
        header === "pinterest" ? (
          <div
            id="header"
            class="flex justify-between items-center gap-16 px-10
               duration-500 ease-in-out"
          >
            <a href="/pinterest">
              <Icon name="meteocons:star-fill" size={80} />
            </a>

            <h1 class="font-cormorant text-3xl ">
              {/* Draw/Write it out  */}
              Ethereal By R &#10084;
            </h1>
          </div>
        ) : (
          <div
            id="header"
            class="flex justify-between items-center gap-16 px-10
               duration-500 ease-in-out"
          >
            <a href="/">
              <Icon name="meteocons:star-fill" size={80} />
            </a>

            <div
              id="menu-btn"
              class="md:hidden cursor-pointer flex flex-col gap-[5px]"
            >
              <span class="block w-10 h-1 bg-violet-300" />
              <span class="block w-10 h-1 bg-violet-300" />
              <span class="block w-10 h-1 bg-violet-300" />
            </div>

            <nav class="hidden md:flex gap-10" id="nav-links">
              {navLinks.map((link) => (
                <a href={link.href}>{link.label}</a>
              ))}
            </nav>
          </div>
        )
      }
    </div>
  </div>

  <!-- Mobile nav -->
  <nav class="flex-col items-end gap-4 mt-4 hidden md:hidden" id="mobile-nav">
    {
      navLinks.map((link) => (
        <a href={link.href} class="flex">
          {link.label}
        </a>
      ))
    }
  </nav>
</header>

<script type="module" is:inline>
  function headerScroll() {
    const shell = document.getElementById("header-shell");
    const header = document.getElementById("header");

    if (!shell || !header) return;

    // Remove previous listener if it exists
    window.onscroll = null;

    window.addEventListener("scroll", () => {
      const active = window.scrollY > 100;

      // Animate width
      shell.classList.toggle("w-3/4", active);
      shell.classList.toggle("w-full", !active);

      // Animate bg/border
      header.classList.toggle("bg-[rgba(19,9,24,0.803)]", active);
      header.classList.toggle("rounded-md", active);
      header.classList.toggle("border-[1px]", active);
      header.classList.toggle("border-[#dab5ef]", active);
    });
  }

  function mobileHamburger() {
    const menuBtn = document.getElementById("menu-btn");
    const mobileNav = document.getElementById("mobile-nav");

    if (!menuBtn || !mobileNav) return;

    // Remove previous click listener to avoid duplicates
    menuBtn.onclick = null;

    menuBtn.addEventListener("click", () => {
      mobileNav.classList.toggle("hidden");
      mobileNav.classList.add("flex");
    });
  }

  function init() {
    headerScroll();
    mobileHamburger();
  }

  init();
  document.addEventListener("astro:after-swap", init);
</script>
